{% extends "admin/base_site.html" %}

{% block content %}
<style>
    .redis-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
    .card { border: 1px solid #ccc; border-radius: 4px; padding: 15px; background: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    .card h3 { border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 0; color: #444; }
    .stat-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px thin #f9f9f9; }
    .value { font-weight: bold; color: #79aec8; }
    .badge { padding: 2px 8px; border-radius: 10px; font-size: 0.8em; color: white; }
    .good { background: #417690; }
    .warning { background: #e8a010; }
</style>

<div id="content-main">
    <h1>{{ title }} <span class="badge good">Redis v{{ info.redis_version }}</span></h1>

    <div class="redis-grid">
        <div class="card">
            <h3>Memory Usage</h3>
            <div class="stat-row"><span>Used Memory:</span> <span class="value">{{ memory.used }}</span></div>
            <div class="stat-row"><span>Peak Memory:</span> <span class="value">{{ memory.peak }}</span></div>
            <div class="stat-row"><span>Fragmentation:</span> <span class="value">{{ memory.fragmentation }}</span></div>
            <div class="stat-row"><span>Lua Engine:</span> <span class="value">{{ memory.lua }}</span></div>
        </div>

        <div class="card">
            <h3>Performance</h3>
            <div class="stat-row"><span>Hit Rate:</span> <span class="value">{{ hit_rate }}%</span></div>
            <div class="stat-row"><span>Ops/Sec:</span> <span class="value">{{ stats.commands_per_sec }}</span></div>
            <div class="stat-row"><span>Expired Keys:</span> <span class="value">{{ stats.expired_keys }}</span></div>
            <div class="stat-row"><span>Evicted Keys:</span> <span class="value" style="color:red">{{ stats.evicted_keys }}</span></div>
        </div>

        <div class="card">
            <h3>Persistence & Server</h3>
            <div class="stat-row"><span>Uptime:</span> <span class="value">{{ info.uptime_in_days }} Days</span></div>
            <div class="stat-row"><span>Last Save:</span> <span class="value">{{ persistence.last_save_status }}</span></div>
            <div class="stat-row"><span>Changes since save:</span> <span class="value">{{ persistence.rdb_changes }}</span></div>
            <div class="stat-row"><span>Clients:</span> <span class="value">{{ info.connected_clients }}</span></div>
        </div>
    </div>

    <details style="margin-top: 30px;">
        <summary style="cursor: pointer; color: #666;">View Raw Redis Info</summary>
        <pre style="background: #f4f4f4; padding: 15px; border-radius: 5px; font-size: 11px;">
            {{ info|pprint }}
        </pre>
    </details>
</div>
{% endblock %}
